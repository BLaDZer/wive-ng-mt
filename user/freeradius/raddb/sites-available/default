server default {
    listen {
	type = auth
	ipv4addr = *
	port = 1812

	limit {
	      max_connections = 32
	      lifetime = 0
	      idle_timeout = 30
	}
    }

    listen {
	ipv4addr = *
	port = 1813
	type = acct

	limit {
	}
    }

    authorize {
	preprocess
	mschap
	eap {
		ok = return
	}
	files
    }

    authenticate {
	Auth-Type MS-CHAP {
		mschap
	}
	eap
    }

    preacct {
	preprocess
	files
    }

    accounting {
	attr_filter.accounting_response
    }


    session {
	radutmp
    }

    post-auth {
	update {
		&reply: += &session-state:
	}

	remove_reply_message_if_eap

	Post-Auth-Type REJECT {
		attr_filter.access_reject
		eap
		remove_reply_message_if_eap
	}
    }

    pre-proxy {
    }

    post-proxy {
	eap
    }
}

#!/bin/sh

PWD=`pwd`

rm -rf $PWD/releases
mkdir -p $PWD/releases

if [ "$2" == "TESTPOINT" ]; then
    # device for regression auto testpoint procedure
    DEVLISTREALGIGADUALBAND="MT7621-MT7603-MT7610-1T1R-16M-USB"
    DEVLISTREALDUALBAND="MT7620-2T2R-MT7610-1T1R-5GHZ-8M-R1.1"
    DEVLISTREALONEBAND="MT7620-2T2R-8M"
else
    # production devices
    DEVLISTREALONEBAND="MT7620-2T2R-8M MT7620-2T2R-8M-AP MT7620-2T2R-8M-IN MT7620-2T2R-4M"
    DEVLISTREALDUALBAND="MT7620-2T2R-MT7610-1T1R-5GHZ-8M-R1.1 MT7620-2T2R-MT7610-1T1R-5GHZ-8M MT7620-2T2R-MT7610-1T1R-5GHZ-8M-AP"
    DEVLISTREALGIGADUALBAND="MT7621-MT7603-MT7610-1T1R-16M-USB"

    # samplase and test for current work pcb`s
    DEVLISTSAMPLES="MT7621-MT7615-2T2R-16M-USB MT7621-MT7615-2T2R-16M-USB-IPA MT7621-MT7615-4T4R-16M-USB"
fi

./clear

# for fabric build only real devices
if [ "$1" = "YES" ]; then
    DEVLIST="$DEVLISTREALGIGADUALBAND $DEVLISTREALDUALBAND $DEVLISTREALONEBAND"
else
    DEVLIST="$DEVLISTSAMPLES $DEVLISTREALGIGADUALBAND $DEVLISTREALDUALBAND $DEVLISTREALONEBAND"
fi

for devname in $DEVLIST
do
    ./clear RELEASE
    nice -19 ./compile "$devname" $1 || exit 1
    cp -f $PWD/images/*.zip $PWD/releases
done
